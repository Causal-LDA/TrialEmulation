<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Set censoring weight model — set_censor_weight_model • TrialEmulation</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set censoring weight model — set_censor_weight_model"><meta name="description" content=""><meta property="og:description" content=""><meta property="og:image" content="https://causal-lda.github.io/TrialEmulation/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrialEmulation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Getting-Started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/new-interface.html">New Interface</a></li>
    <li><a class="dropdown-item" href="../articles/Extending-TrialEmulation.html">Extending TrialEmulation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/Causal-LDA/TrialEmulation/" aria-label="github"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Set censoring weight model</h1>
      <small class="dont-index">Source: <a href="https://github.com/Causal-LDA/TrialEmulation/blob/v0.0.4.5/R/trial_sequence.R" class="external-link"><code>R/trial_sequence.R</code></a></small>
      <div class="d-none name"><code>set_censor_weight_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">set_censor_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">censor_event</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  pool_models <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">model_fitter</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence'</span></span>
<span><span class="fu">set_censor_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">censor_event</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  pool_models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"both"</span>, <span class="st">"numerator"</span><span class="op">)</span>,</span>
<span>  model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence_PP'</span></span>
<span><span class="fu">set_censor_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">censor_event</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  pool_models <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence_ITT'</span></span>
<span><span class="fu">set_censor_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">censor_event</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  pool_models <span class="op">=</span> <span class="st">"numerator"</span>,</span>
<span>  model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'trial_sequence_AT'</span></span>
<span><span class="fu">set_censor_weight_model</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">censor_event</span>,</span>
<span>  <span class="va">numerator</span>,</span>
<span>  <span class="va">denominator</span>,</span>
<span>  pool_models <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>trial_sequence.</p></dd>


<dt id="arg-censor-event">censor_event<a class="anchor" aria-label="anchor" href="#arg-censor-event"></a></dt>
<dd><p>string. Name of column containing censoring indicator.</p></dd>


<dt id="arg-numerator">numerator<a class="anchor" aria-label="anchor" href="#arg-numerator"></a></dt>
<dd><p>A RHS formula to specify the logistic models for estimating the numerator terms of the inverse
probability of censoring weights.</p></dd>


<dt id="arg-denominator">denominator<a class="anchor" aria-label="anchor" href="#arg-denominator"></a></dt>
<dd><p>A RHS formula to specify the logistic models for estimating the denominator terms of the inverse
probability of censoring weights.</p></dd>


<dt id="arg-pool-models">pool_models<a class="anchor" aria-label="anchor" href="#arg-pool-models"></a></dt>
<dd><p>Fit pooled or separate censoring models for those treated and those untreated at the immediately
previous visit. Pooling can be specified for the models for the numerator and denominator terms of the inverse
probability of censoring weights. One of "none", "numerator", or "both" (default is "none" except when estimand =
"ITT" then default is "numerator").</p></dd>


<dt id="arg-model-fitter">model_fitter<a class="anchor" aria-label="anchor" href="#arg-model-fitter"></a></dt>
<dd><p>An object of class  <code>te_model_fitter</code> which determines the method used for fitting the weight
models. For logistic regression use <code><a href="stats_glm_logit.html">stats_glm_logit()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>object</code> is returned with <code>@censor_weights</code> set</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="trial_sequence.html">trial_sequence</a></span><span class="op">(</span><span class="st">"ITT"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_data.html">set_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_censored</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">set_censor_weight_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>    censor_event <span class="op">=</span> <span class="st">"censored"</span>,</span></span>
<span class="r-in"><span>    numerator <span class="op">=</span> <span class="op">~</span> <span class="va">age_s</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x3</span>,</span></span>
<span class="r-in"><span>    denominator <span class="op">=</span> <span class="op">~</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>,</span></span>
<span class="r-in"><span>    pool_models <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>    model_fitter <span class="op">=</span> <span class="fu"><a href="stats_glm_logit.html">stats_glm_logit</a></span><span class="op">(</span>save_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trial Sequence Object </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimand: Intention-to-treat </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - N: 725 observations from 89 patients </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         id period treatment    x1           x2    x3        x4   age      age_s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt;  &lt;int&gt;     &lt;num&gt; &lt;num&gt;        &lt;num&gt; &lt;int&gt;     &lt;num&gt; &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     1      0         1     1  1.146148362     0 0.7342030    36 0.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     1      1         1     1  0.002200337     0 0.7342030    37 0.16666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 724:    99      6         1     1 -0.033762356     1 0.5752681    71 3.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 725:    99      7         0     0 -1.340496520     1 0.5752681    72 3.08333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      outcome censored eligible time_on_regime</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;    &lt;int&gt;    &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:       0        0        1              0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:       0        0        0              1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 724:       0        0        0              1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 725:       1        0        0              2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> IPW for informative censoring: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Numerator formula: 1 - censored ~ age_s + x1 + x3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Denominator formula: 1 - censored ~ x3 + x4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Numerator and denominotor models are pooled across treatment arms. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Model fitter type: te_stats_glm_logit </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Weight models not fitted. Use calculate_weights() </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sequence of Trials Data: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Use set_expansion_options() and expand_trials() to construct the sequence of trials dataset. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome model: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - Outcome model not specified. Use set_outcome_model() </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Gravestock, Li Su, Roonak Rezvani, Julia Moesch, Medical Research Council (MRC), F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

