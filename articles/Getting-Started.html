<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting-Started • RandomisedTrialsEmulation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting-Started">
<meta property="og:description" content="RandomisedTrialsEmulation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RandomisedTrialsEmulation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Getting-Started.html">Getting-Started</a>
    </li>
    <li>
      <a href="../articles/JSS_Rmd/MyJSSArticle.html">A Capitalized Title: Something about a Package \pkg{foo}</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Getting-Started_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting-Started</h1>
            
      
      
      <div class="hidden name"><code>Getting-Started.Rmd</code></div>

    </div>

    
    
<p>This package implements methods to analyse a sequence of target trials.</p>
<p>The steps to do this are:</p>
<ol style="list-style-type: decimal">
<li>create the data set with all the required variables</li>
<li>fit models for censoring and calculate weights</li>
<li>expand the data set, with records for each eligible patient for each trial period</li>
<li>fit models for outcomes</li>
</ol>
<p>Some of the functions are inspired by the <a href="https://causalab.sph.harvard.edu/software/" class="external-link">INITIATORS SAS macro</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RandomisedTrialsEmulation</span><span class="op">)</span></span></code></pre></div>
<p>There is an all-in-one function <code>initators()</code> which does all of the steps with one function call.</p>
<p>Currently, datasets are handled with csv files<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>To get started a longitudinal dataset must be created and saved as a csv. This should have:</p>
<ul>
<li>time period</li>
<li>patient identifier</li>
<li>treatment indicator</li>
<li>outcome indicator</li>
<li>eligibility indicator for trial start in period</li>
<li>other covariates relating to treatment, outcome, or censoring to be used in the models for weights or the outcome</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare the example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"trial_example"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for the purposes of the vignette, we use a temporary directory, however it may be useful to use a permanent location</span></span>
<span><span class="co"># in order to inspect the outputs later</span></span>
<span><span class="va">working_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"trial_emu"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">working_dir</span><span class="op">)</span></span></code></pre></div>
<p>Call the <code><a href="../reference/initiators.html">initiators()</a></code> function to run the complete analysis:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/initiators.html">initiators</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">trial_example</span>,</span>
<span>    id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>    period <span class="op">=</span> <span class="st">"period"</span>,</span>
<span>    eligible <span class="op">=</span> <span class="st">"eligible"</span>,</span>
<span>    treatment <span class="op">=</span> <span class="st">"treatment"</span>,</span>
<span>    outcome <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>    model_var <span class="op">=</span> <span class="st">"assigned_treatment"</span>,</span>
<span>    outcomeCov_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catvarA"</span>, <span class="st">"catvarB"</span>, <span class="st">"catvarC"</span>, <span class="st">"nvarA"</span>, <span class="st">"nvarB"</span>, <span class="st">"nvarC"</span><span class="op">)</span>,</span>
<span>    outcomeCov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catvarA"</span>, <span class="st">"catvarB"</span>, <span class="st">"catvarC"</span>, <span class="st">"nvarA"</span>, <span class="st">"nvarB"</span>, <span class="st">"nvarC"</span><span class="op">)</span>,</span>
<span>    outcomeClass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catvarA"</span>, <span class="st">"catvarB"</span>, <span class="st">"catvarC"</span><span class="op">)</span>,</span>
<span>    numCores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    data_dir <span class="op">=</span> <span class="va">working_dir</span>,</span>
<span>    use_censor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    use_weight <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Start data manipulation"</span></span>
<span><span class="co">#&gt; [1] "Finish data manipulation"</span></span>
<span><span class="co">#&gt; [1] "Processing time of data manipulation:"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.673   0.028   0.701 </span></span>
<span><span class="co">#&gt; [1] "----------------------------"</span></span>
<span><span class="co">#&gt; [1] "Start data extension"</span></span>
<span><span class="co">#&gt; [1] "Finish data extension"</span></span>
<span><span class="co">#&gt; [1] "Processing time of data extension:"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   5.266   0.996   6.262 </span></span>
<span><span class="co">#&gt; [1] "----------------------------"</span></span>
<span><span class="co">#&gt; [1] "Number of observations in expanded data: 1939053"</span></span>
<span><span class="co">#&gt; [1] "Base Analysis"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = as.formula(regform), family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = temp_data, weights = temp_data[, weight], control = parglm::parglm.control(nthreads = 4, </span></span>
<span><span class="co">#&gt;         method = "FAST"), method = parglm::parglm.fit, singular.ok = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals: </span></span>
<span><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">#&gt; -0.4458  -0.1072  -0.0879  -0.0680   3.9317  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)        -3.118e+00  1.392e-01 -22.407  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; assigned_treatment -2.686e-01  4.642e-02  -5.786 7.22e-09 ***</span></span>
<span><span class="co">#&gt; for_period          2.018e-03  2.416e-04   8.354  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; followup_time       1.400e-03  2.037e-04   6.873 6.28e-12 ***</span></span>
<span><span class="co">#&gt; catvarA1            2.945e-01  2.812e-02  10.474  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; catvarA2            1.355e-01  3.889e-02   3.484 0.000495 ***</span></span>
<span><span class="co">#&gt; catvarA3           -1.103e+01  3.486e+01  -0.317 0.751611    </span></span>
<span><span class="co">#&gt; catvarA7            4.472e-01  3.808e-02  11.742  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; catvarB1           -3.914e-01  1.115e-01  -3.510 0.000449 ***</span></span>
<span><span class="co">#&gt; catvarB2           -4.139e-01  1.153e-01  -3.589 0.000332 ***</span></span>
<span><span class="co">#&gt; catvarB3           -2.417e+00  3.352e-01  -7.211 5.57e-13 ***</span></span>
<span><span class="co">#&gt; catvarB7           -7.030e-01  1.122e-01  -6.264 3.76e-10 ***</span></span>
<span><span class="co">#&gt; catvarC1           -4.846e-02  3.463e-02  -1.399 0.161666    </span></span>
<span><span class="co">#&gt; catvarC2           -6.469e-02  3.557e-02  -1.819 0.068942 .  </span></span>
<span><span class="co">#&gt; catvarC7           -1.157e-01  3.514e-02  -3.293 0.000990 ***</span></span>
<span><span class="co">#&gt; nvarA              -8.422e-02  7.711e-03 -10.922  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nvarB               5.188e-03  3.196e-04  16.232  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nvarC              -4.223e-02  8.845e-04 -47.738  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 111015  on 1939052  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 107647  on 1939035  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 107683</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "-------------------------------------------------"</span></span>
<span><span class="co">#&gt; [1] "Processing time of modeling for base analysis:"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  14.818   0.363   9.259 </span></span>
<span><span class="co">#&gt; [1] "Base Analysis with robust variance"</span></span>
<span><span class="co">#&gt; [1] "-------------------------------------------------------"</span></span>
<span><span class="co">#&gt; [1] "Robust standard error:"</span></span>
<span><span class="co">#&gt; $summary</span></span>
<span><span class="co">#&gt;                  names      estimate   robust_se            lb            ub</span></span>
<span><span class="co">#&gt;  1:        (Intercept)  -3.118051443 0.651305029 -4.394609e+00  -1.841493586</span></span>
<span><span class="co">#&gt;  2: assigned_treatment  -0.268581621 0.305822238 -8.679932e-01   0.330829966</span></span>
<span><span class="co">#&gt;  3:         for_period   0.002018357 0.001584351 -1.086971e-03   0.005123685</span></span>
<span><span class="co">#&gt;  4:      followup_time   0.001400200 0.001502395 -1.544495e-03   0.004344895</span></span>
<span><span class="co">#&gt;  5:           catvarA1   0.294499103 0.190130311 -7.815631e-02   0.667154513</span></span>
<span><span class="co">#&gt;  6:           catvarA2   0.135462387 0.280060741 -4.134567e-01   0.684381439</span></span>
<span><span class="co">#&gt;  7:           catvarA3 -11.034924842 0.373929370 -1.176783e+01 -10.302023277</span></span>
<span><span class="co">#&gt;  8:           catvarA7   0.447172141 0.220517894  1.495707e-02   0.879387213</span></span>
<span><span class="co">#&gt;  9:           catvarB1  -0.391385512 0.301592332 -9.825065e-01   0.199735457</span></span>
<span><span class="co">#&gt; 10:           catvarB2  -0.413877810 0.364909486 -1.129100e+00   0.301344782</span></span>
<span><span class="co">#&gt; 11:           catvarB3  -2.416817855 0.926339050 -4.232442e+00  -0.601193318</span></span>
<span><span class="co">#&gt; 12:           catvarB7  -0.702964113 0.300658612 -1.292255e+00  -0.113673232</span></span>
<span><span class="co">#&gt; 13:           catvarC1  -0.048464570 0.154632664 -3.515446e-01   0.254615453</span></span>
<span><span class="co">#&gt; 14:           catvarC2  -0.064693710 0.225980638 -5.076158e-01   0.378228340</span></span>
<span><span class="co">#&gt; 15:           catvarC7  -0.115713701 0.174240445 -4.572250e-01   0.225797571</span></span>
<span><span class="co">#&gt; 16:              nvarA  -0.084223840 0.045064026 -1.725493e-01   0.004101650</span></span>
<span><span class="co">#&gt; 17:              nvarB   0.005187797 0.002229197  8.185716e-04   0.009557022</span></span>
<span><span class="co">#&gt; 18:              nvarC  -0.042225997 0.006668085 -5.529544e-02  -0.029156549</span></span>
<span><span class="co">#&gt;               z   p_value</span></span>
<span><span class="co">#&gt;  1:  -4.7873904   &lt; 0.001</span></span>
<span><span class="co">#&gt;  2:  -0.8782279 0.3798201</span></span>
<span><span class="co">#&gt;  3:   1.2739329 0.2026872</span></span>
<span><span class="co">#&gt;  4:   0.9319784 0.3513477</span></span>
<span><span class="co">#&gt;  5:   1.5489329 0.1213978</span></span>
<span><span class="co">#&gt;  6:   0.4836893 0.6286064</span></span>
<span><span class="co">#&gt;  7: -29.5107197   &lt; 0.001</span></span>
<span><span class="co">#&gt;  8:   2.0278270 0.0425779</span></span>
<span><span class="co">#&gt;  9:  -1.2977303 0.1943800</span></span>
<span><span class="co">#&gt; 10:  -1.1341931 0.2567136</span></span>
<span><span class="co">#&gt; 11:  -2.6089992 0.0090807</span></span>
<span><span class="co">#&gt; 12:  -2.3380807 0.0193831</span></span>
<span><span class="co">#&gt; 13:  -0.3134174 0.7539636</span></span>
<span><span class="co">#&gt; 14:  -0.2862799 0.7746638</span></span>
<span><span class="co">#&gt; 15:  -0.6641036 0.5066240</span></span>
<span><span class="co">#&gt; 16:  -1.8689817 0.0616254</span></span>
<span><span class="co">#&gt; 17:   2.3272047 0.0199544</span></span>
<span><span class="co">#&gt; 18:  -6.3325518   &lt; 0.001</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $matrix</span></span>
<span><span class="co">#&gt;                      (Intercept) assigned_treatment    for_period followup_time</span></span>
<span><span class="co">#&gt; (Intercept)         0.4241982410       2.860127e-02 -6.829567e-04 -4.153396e-04</span></span>
<span><span class="co">#&gt; assigned_treatment  0.0286012658       9.352724e-02 -8.106049e-05 -8.709797e-06</span></span>
<span><span class="co">#&gt; for_period         -0.0006829567      -8.106049e-05  2.510168e-06  8.155632e-07</span></span>
<span><span class="co">#&gt; followup_time      -0.0004153396      -8.709797e-06  8.155632e-07  2.257192e-06</span></span>
<span><span class="co">#&gt; catvarA1           -0.0076492374       5.499013e-03 -2.341545e-06  2.272532e-05</span></span>
<span><span class="co">#&gt; catvarA2           -0.0073172060       8.897060e-03  2.166352e-05  2.034110e-05</span></span>
<span><span class="co">#&gt; catvarA3           -0.0126703094       6.837776e-03  8.333373e-06  3.121913e-05</span></span>
<span><span class="co">#&gt; catvarA7           -0.0259525024      -1.257821e-04  7.328857e-05  4.828833e-05</span></span>
<span><span class="co">#&gt; catvarB1           -0.0863450453      -1.966458e-02  2.364906e-05  5.150837e-05</span></span>
<span><span class="co">#&gt; catvarB2           -0.0857030227      -2.383448e-02  2.126874e-05  5.741728e-05</span></span>
<span><span class="co">#&gt; catvarB3           -0.1390602206      -2.482296e-02  1.448446e-04  3.088447e-04</span></span>
<span><span class="co">#&gt; catvarB7           -0.1270158203      -1.790081e-02  1.533386e-04  5.170989e-05</span></span>
<span><span class="co">#&gt; catvarC1           -0.0035452616      -4.867533e-03  1.699586e-07 -7.781448e-08</span></span>
<span><span class="co">#&gt; catvarC2           -0.0039531483      -9.935630e-03  5.098074e-05  1.344065e-05</span></span>
<span><span class="co">#&gt; catvarC7           -0.0133023782      -4.219004e-03  4.395430e-05 -3.198073e-07</span></span>
<span><span class="co">#&gt; nvarA              -0.0026826527      -1.031122e-03  6.136072e-06 -1.261030e-05</span></span>
<span><span class="co">#&gt; nvarB               0.0001453586       6.647543e-05 -9.460367e-07  4.318871e-07</span></span>
<span><span class="co">#&gt; nvarC              -0.0025163451       4.991646e-06 -3.482926e-08  9.484013e-07</span></span>
<span><span class="co">#&gt;                         catvarA1      catvarA2      catvarA3      catvarA7</span></span>
<span><span class="co">#&gt; (Intercept)        -7.649237e-03 -7.317206e-03 -1.267031e-02 -2.595250e-02</span></span>
<span><span class="co">#&gt; assigned_treatment  5.499013e-03  8.897060e-03  6.837776e-03 -1.257821e-04</span></span>
<span><span class="co">#&gt; for_period         -2.341545e-06  2.166352e-05  8.333373e-06  7.328857e-05</span></span>
<span><span class="co">#&gt; followup_time       2.272532e-05  2.034110e-05  3.121913e-05  4.828833e-05</span></span>
<span><span class="co">#&gt; catvarA1            3.614954e-02  2.236178e-02  1.523361e-02  1.370441e-02</span></span>
<span><span class="co">#&gt; catvarA2            2.236178e-02  7.843402e-02  1.901809e-02  1.948025e-02</span></span>
<span><span class="co">#&gt; catvarA3            1.523361e-02  1.901809e-02  1.398232e-01  1.857852e-02</span></span>
<span><span class="co">#&gt; catvarA7            1.370441e-02  1.948025e-02  1.857852e-02  4.862814e-02</span></span>
<span><span class="co">#&gt; catvarB1            6.079283e-03  9.181747e-04  1.861284e-03  4.240412e-03</span></span>
<span><span class="co">#&gt; catvarB2            8.225614e-04  2.196601e-03  2.171415e-03  6.250625e-03</span></span>
<span><span class="co">#&gt; catvarB3            8.496064e-03  1.264987e-02 -6.325683e-04  1.389120e-02</span></span>
<span><span class="co">#&gt; catvarB7            3.444233e-03  1.840269e-03 -3.149845e-03  3.640336e-03</span></span>
<span><span class="co">#&gt; catvarC1           -7.532400e-04  3.242170e-03  2.711572e-03  2.734002e-03</span></span>
<span><span class="co">#&gt; catvarC2           -9.312879e-03 -6.154713e-03 -1.862415e-04  2.649270e-03</span></span>
<span><span class="co">#&gt; catvarC7            1.153240e-03 -3.145133e-03 -7.404987e-03 -6.524512e-03</span></span>
<span><span class="co">#&gt; nvarA              -3.969376e-04 -1.243125e-04 -1.049060e-04 -2.561479e-04</span></span>
<span><span class="co">#&gt; nvarB              -2.233248e-05 -2.891017e-05  2.590007e-06 -1.373227e-05</span></span>
<span><span class="co">#&gt; nvarC              -2.224687e-04 -2.964685e-04 -9.635408e-05 -1.660404e-04</span></span>
<span><span class="co">#&gt;                         catvarB1      catvarB2      catvarB3      catvarB7</span></span>
<span><span class="co">#&gt; (Intercept)        -8.634505e-02 -8.570302e-02 -1.390602e-01 -1.270158e-01</span></span>
<span><span class="co">#&gt; assigned_treatment -1.966458e-02 -2.383448e-02 -2.482296e-02 -1.790081e-02</span></span>
<span><span class="co">#&gt; for_period          2.364906e-05  2.126874e-05  1.448446e-04  1.533386e-04</span></span>
<span><span class="co">#&gt; followup_time       5.150837e-05  5.741728e-05  3.088447e-04  5.170989e-05</span></span>
<span><span class="co">#&gt; catvarA1            6.079283e-03  8.225614e-04  8.496064e-03  3.444233e-03</span></span>
<span><span class="co">#&gt; catvarA2            9.181747e-04  2.196601e-03  1.264987e-02  1.840269e-03</span></span>
<span><span class="co">#&gt; catvarA3            1.861284e-03  2.171415e-03 -6.325683e-04 -3.149845e-03</span></span>
<span><span class="co">#&gt; catvarA7            4.240412e-03  6.250625e-03  1.389120e-02  3.640336e-03</span></span>
<span><span class="co">#&gt; catvarB1            9.095793e-02  7.785437e-02  9.420332e-02  7.350656e-02</span></span>
<span><span class="co">#&gt; catvarB2            7.785437e-02  1.331589e-01  1.156254e-01  7.663653e-02</span></span>
<span><span class="co">#&gt; catvarB3            9.420332e-02  1.156254e-01  8.581040e-01  9.243423e-02</span></span>
<span><span class="co">#&gt; catvarB7            7.350656e-02  7.663653e-02  9.243423e-02  9.039560e-02</span></span>
<span><span class="co">#&gt; catvarC1            4.247519e-03  5.432604e-03 -9.041683e-03  1.661290e-03</span></span>
<span><span class="co">#&gt; catvarC2            5.458255e-03  1.299103e-02 -1.923855e-02  2.343721e-03</span></span>
<span><span class="co">#&gt; catvarC7            4.554950e-04 -3.591917e-03  4.756941e-03 -5.464618e-03</span></span>
<span><span class="co">#&gt; nvarA               6.522743e-04  1.682212e-03 -7.356753e-04  1.450788e-03</span></span>
<span><span class="co">#&gt; nvarB              -1.593246e-04 -1.626345e-04 -1.744479e-04 -1.463417e-04</span></span>
<span><span class="co">#&gt; nvarC               1.231490e-04  7.007058e-05  7.887447e-05  2.918665e-04</span></span>
<span><span class="co">#&gt;                         catvarC1      catvarC2      catvarC7         nvarA</span></span>
<span><span class="co">#&gt; (Intercept)        -3.545262e-03 -3.953148e-03 -1.330238e-02 -2.682653e-03</span></span>
<span><span class="co">#&gt; assigned_treatment -4.867533e-03 -9.935630e-03 -4.219004e-03 -1.031122e-03</span></span>
<span><span class="co">#&gt; for_period          1.699586e-07  5.098074e-05  4.395430e-05  6.136072e-06</span></span>
<span><span class="co">#&gt; followup_time      -7.781448e-08  1.344065e-05 -3.198073e-07 -1.261030e-05</span></span>
<span><span class="co">#&gt; catvarA1           -7.532400e-04 -9.312879e-03  1.153240e-03 -3.969376e-04</span></span>
<span><span class="co">#&gt; catvarA2            3.242170e-03 -6.154713e-03 -3.145133e-03 -1.243125e-04</span></span>
<span><span class="co">#&gt; catvarA3            2.711572e-03 -1.862415e-04 -7.404987e-03 -1.049060e-04</span></span>
<span><span class="co">#&gt; catvarA7            2.734002e-03  2.649270e-03 -6.524512e-03 -2.561479e-04</span></span>
<span><span class="co">#&gt; catvarB1            4.247519e-03  5.458255e-03  4.554950e-04  6.522743e-04</span></span>
<span><span class="co">#&gt; catvarB2            5.432604e-03  1.299103e-02 -3.591917e-03  1.682212e-03</span></span>
<span><span class="co">#&gt; catvarB3           -9.041683e-03 -1.923855e-02  4.756941e-03 -7.356753e-04</span></span>
<span><span class="co">#&gt; catvarB7            1.661290e-03  2.343721e-03 -5.464618e-03  1.450788e-03</span></span>
<span><span class="co">#&gt; catvarC1            2.391126e-02  1.207299e-02  2.902483e-03  7.840493e-05</span></span>
<span><span class="co">#&gt; catvarC2            1.207299e-02  5.106725e-02  6.509224e-03  7.600245e-04</span></span>
<span><span class="co">#&gt; catvarC7            2.902483e-03  6.509224e-03  3.035973e-02 -3.678583e-04</span></span>
<span><span class="co">#&gt; nvarA               7.840493e-05  7.600245e-04 -3.678583e-04  2.030766e-03</span></span>
<span><span class="co">#&gt; nvarB              -2.980473e-05 -4.798836e-05  2.402226e-05 -3.632210e-05</span></span>
<span><span class="co">#&gt; nvarC              -6.282048e-05 -2.518488e-04 -2.159651e-05  1.966967e-05</span></span>
<span><span class="co">#&gt;                            nvarB         nvarC</span></span>
<span><span class="co">#&gt; (Intercept)         1.453586e-04 -2.516345e-03</span></span>
<span><span class="co">#&gt; assigned_treatment  6.647543e-05  4.991646e-06</span></span>
<span><span class="co">#&gt; for_period         -9.460367e-07 -3.482926e-08</span></span>
<span><span class="co">#&gt; followup_time       4.318871e-07  9.484013e-07</span></span>
<span><span class="co">#&gt; catvarA1           -2.233248e-05 -2.224687e-04</span></span>
<span><span class="co">#&gt; catvarA2           -2.891017e-05 -2.964685e-04</span></span>
<span><span class="co">#&gt; catvarA3            2.590007e-06 -9.635408e-05</span></span>
<span><span class="co">#&gt; catvarA7           -1.373227e-05 -1.660404e-04</span></span>
<span><span class="co">#&gt; catvarB1           -1.593246e-04  1.231490e-04</span></span>
<span><span class="co">#&gt; catvarB2           -1.626345e-04  7.007058e-05</span></span>
<span><span class="co">#&gt; catvarB3           -1.744479e-04  7.887447e-05</span></span>
<span><span class="co">#&gt; catvarB7           -1.463417e-04  2.918665e-04</span></span>
<span><span class="co">#&gt; catvarC1           -2.980473e-05 -6.282048e-05</span></span>
<span><span class="co">#&gt; catvarC2           -4.798836e-05 -2.518488e-04</span></span>
<span><span class="co">#&gt; catvarC7            2.402226e-05 -2.159651e-05</span></span>
<span><span class="co">#&gt; nvarA              -3.632210e-05  1.966967e-05</span></span>
<span><span class="co">#&gt; nvarB               4.969318e-06  1.003238e-06</span></span>
<span><span class="co">#&gt; nvarC               1.003238e-06  4.446336e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "----------------------------------------------"</span></span>
<span><span class="co">#&gt; [1] "Processing time of getting the output and sandwich with reduced switch data:"</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   2.369   0.416   2.789</span></span></code></pre></div>
<p><code><a href="../reference/initiators.html">initiators()</a></code> creates a few additional data files, depending on the selected options</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">working_dir</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "switch_data.csv"</span></span></code></pre></div>
<ul>
<li>
<code>sw_data</code> is created in the first step and contains all the necessary variables for the next steps</li>
<li>
<code>switch_data</code> is the extended data</li>
</ul>
<p>Instead of using <code><a href="../reference/initiators.html">initiators()</a></code> it is possible to run each step individually with <code><a href="../reference/data_preparation.html">data_preparation()</a></code>, <code><a href="../reference/data_modelling.html">data_modelling()</a></code> etc.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_modelling.html">data_modelling</a></span><span class="op">(</span></span>
<span>  outcomeCov_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catvarA"</span>, <span class="st">"catvarB"</span>, <span class="st">"catvarC"</span>, <span class="st">"nvarA"</span>, <span class="st">"nvarB"</span>, <span class="st">"nvarC"</span><span class="op">)</span>,</span>
<span>  model_var <span class="op">=</span> <span class="st">"assigned_treatment"</span>,</span>
<span>  include_followup_time_case <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  include_expansion_time_case <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  absolutePath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working_dir</span>, <span class="st">"switch_data.csv"</span><span class="op">)</span>,</span>
<span>  use_sample_weights <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Saving the data to disk as csv allows us to use various techniques when the expanded data set becomes very large and no longer fit easily in memory.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Roonak Rezvani, Isaac Gravestock, Li Su.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
